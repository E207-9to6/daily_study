# IPv6 (Internet Protocol version 6)
## IPv6 데이터그램 포맷
![image](https://github.com/E207-9to6/daily_study/assets/68316096/94d94aa5-c472-478c-80ee-205206ef8407)  
- `version`: IP프로토콜 버전을 의미, 6으로 설정됨(4bit)

- `traffic class` 또는 `priority`: IPv6 패킷의 클래스나 우선순위를 나타냄. IPv4의 TOS(Type Of Service)필드와 유사한 기능을 함(8bit)
  + IPv6 패킷 중 QoS(Quality of Service)를 보장해줘야 할 필요성이 있는 패킷과 그렇지 않은 패킷을 구분할 때 사용됨   

- `Flow label`: 동일한 서비스 클래스를 필요로 하는 패킷들을 표현할 때 사옹됨.(20bits)
  + 플로우 레이블은 기본적으로 0으로 설정되는데 음성, 화상 등의 실시간 데이터 트래픽을 나타내기 위해 0이 아닌 값으로 설정될 수 있음

- `Payload length`: 확장 헤더와 데이터 필드를 합하여 페이로드라고 한다. 페이로드 크기는 최대 65,535 바이트다.

- `Next Header`: IPv6 기본 헤더 이후에 전송되는 데이터 종류를 나타내는 확장 옵션 또는 상위 계층 데이터의 종류를 지정함

- `Hop Limit`: 패킷이 경유할 수 있는 최대 라우터 홉 수를 나타냄. IPv4의 TTL과 같음

### IPv4, IPv6 헤더 비교
![image](https://github.com/E207-9to6/daily_study/assets/68316096/bfa657a9-6e55-4a24-9a4b-fa92551abb20)  

1. IPv4의 헤더 길이, 헤더 체크섬, 식별자, 플래그, 분할 오프셋 필드가 제거됨

2. IPv4는 헤더 길이가 가변적이어서 헤더 길이 필드가 필요했다. 그러나, *IPv6은 기본 헤더 길이가 40바이트로 고정*되어 헤더 길이 필드가 필요하지 않음.

3. 헤더 체크섬 필드는 라워에서의 처리 시간 감소를 위해 제거됨
  - 오류 검사는 데이터 링크 계층과 상위 계층에서 이루어짐

4. 경로 MTU를 미리 탐색하여 송신 호스트에서 패킷을 미리 분할하기 때문에 IPv4의 식별자, 플래그, 분할 오프셋 필드가 필요하지 않음

5. service type 필드는 traffic class로 대체됨

## 장점
### IP 주소의 확장
- IPv6는 16비트 단위로 8부분으로 표시하며 총 128비트 주소공간을 제공
  + IPv4는 32비트

### 호스트 주소 자동 설정
- IPv6 호스트는 IPv6 네트워크에 접속하는 순간 자동적으로 네트워크 주소를 부여받음
- IPv4: 네트워크 관리자로부터IP 주소를 부여받아 수동으로 설정

### 패킷 크기 확장
- IPv6은 jumbogram 옵션을 사용하면 임의의 호스트 사이에 큰 크기의 패킷을 주고받을 수 있음
  + 대역폭이 넓은 네트워크를 더 효율적으로 사용 가능
- IPv4 패킷 크기는 64KB로 제한되어 있음

### Flow Labeling
- 보통 라우터에서 경로설정을 위한 처리를 하는데, flow label이 있으면 그 안에 경로정보가 있어 라우팅 생략하고 전송 가능 -> 속도가 빨라짐
- IPv6에서는 flow label이 있어 라우터에서 데이터그램을 처리할 필요가 없음

## IPv6의 전송방식
### 유니캐스트
1:1 전송 방식  

### 멀티캐스트
1:N    
- 특정 그룹에 속한 모든 호스트로 전송

### 애니캐스트
1:1  
- 수신자들을 묶어 하나의 그룹으로 나타낸 주소를 사용하여 그룹 내에서 가장 가까운 호스트에게만 전송하는 방식

- 다수의 수신자에게 패킷을 보낸다는 점에서 멀티캐스트와 비슷하지만 해당 그룹에 속하는 모든 호스트로 패킷이 전달되지 않고 가장 가까운 거리에 있는 호스트에게만 패킷이 전달된다는 점이 다르다.

## IPv4/IPv6 변환 방법
- IPv6 망을 확대하면서 기존 IPv4 망과 공존 가능한 방법

### 이중 스택, Dual Stack
- 장비들이 IPv4, IPv6 모두 지원, 동시 처리 가능

- 통신 상대방에 따라 적절한 IP프로토콜 선택

### 터널링, Tunneling
- 2개의 IPv6 호스트 사이에 IPv4 망이 있을 경우에, IPv6 패킷을 IPv4 패킷 속에 캡슐화하여 사용하는 기술

### 헤더 변환, Header Translation
- IPv6와 IPv4 사이의 게이트웨이에서 서로 간의 헤더 형식을 변환하는 방법

- IPv6 형식의 헤더를 IPv4 헤더 형식으로 변환 가능. 또는 반대로도 가능
